program Readability;

uses Classes, SysUtils;

//type arraytype = array [1..100] of

//procedure ReadData(test);

var
  A, D: TStringArray;
  inputStr, word, repeated, lastrepeated, ww, tempword: string;
  ASL, rcount, wcount, dlength, i: integer;
  words, chars, sents, readab, lastredab: real;
  infile, dictionary:text;

 begin
  //Read text file
assign (infile, 'SBA.txt');
reset(infile);
while not EOF(infile) do
begin
  readln(infile,inputStr);
end;

writeln('Your passage: ');
writeln(inputStr);

 //Read dictionary
assign (dictionary,'Word_List.txt');
dlength := 0;
SetLength(D,dlength);
reset(dictionary);
while not EOF(dictionary) do
begin
  dlength:= dlength+1;
  SetLength(D, dlength);
  readln(dictionary,D[dlength-1]);
end;



  //Readability calculator
  words:=0;
  tempword:=' ';
  chars:=0;
  sents:=0;
  readab:=0;
  lastredab:=1;
  ASL:= 0;

  repeated:='repeat';
  lastrepeated:='lastrepeat';
  rcount:=0;

  wcount:=0;

  A := inputStr.Split(' ');


  for word in A do
  begin
    words := words + 1;
    tempword:= Trim(word);
    if pos('.',word)<> 0 then
    begin
      sents := sents+1;
      tempword:= Copy(word,1,(Length(word)-1));
    end;
    if pos('!',word)<> 0 then
    begin
      sents := sents+1;
      tempword:= Copy(word,1,(Length(word)-1));
    end;
    if pos('?',word)<> 0 then
    begin;
      sents := sents+1;
      tempword:= Copy(word,1,(Length(word)-1));
    end;


    if tempword = repeated then
       rcount := rcount+1;

    for ww in D do
    begin
         if tempword = ww then
         wcount:=wcount+1;
    end;
  end;

  //Results

  Writeln();
  Writeln('Number of words in passage: ', round(words));

  chars := length(inputStr);
  chars := chars - words + 1;
  Writeln('Number of characters in passage: ', round(chars));

  Writeln('Number of sentences in passage: ', round(sents));
  Writeln();

  readab := 4.71*chars / words + 0.5*words / sents-21.43;

  readab:=round(readab);

  if readab < 8 then
    writeln('Your passage is too simple! Try harder! Readability score of your passage is: ', round(readab))
  else if (readab < 14) and (readab >7) then
    writeln('Your passage is good! Readability score of your passage is: ', round(readab))
  else if readab > 13 then
    writeln('Your passage is very high quality! Readability score of your passage is: ', round(readab));


  if readab >= lastredab then
     Writeln('Your previous readability score was ', round(lastredab), ' , you have improved!')
  else if readab < lastredab then
     Writeln('Your previous readability score was ', round(lastredab), ' , add oil!');


  ASL:= round(words/sents);
  Writeln('Your average sentence length is: ', ASL, ' word(s).');
  Writeln();

  Writeln('Your most repeated word is ', repeated, ', you have used it for ', rcount, ' times.');
  If repeated = lastrepeated then
     Writeln('You have been repeatedly using the same word! Try to avoid it!')
  else if repeated <> lastrepeated then
     Writeln('You stopped using your previous repeated word as much! Good job!');

  Writeln();

  Writeln('You have made ', wcount, ' common mistakes.');

  //Storing results for next use
  lastrepeated := repeated;
  lastredab := readab;

  Readln;
end.       
